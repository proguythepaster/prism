<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>prism</title>
<style>
    body {
        font-family: Arial, sans-serif;
        background: #0f0f0f;
        color: #0026ff;
        margin: 0;
        padding: 0;
    }

    .top-bar {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 20px;
        background: #0f0f0f;
        z-index: 10;
        position: relative;
    }

    h1 {
        margin: 0;
        font-size: 28px;
    }

    .search-box {
        display: flex;
    }

    input {
        width: 300px;
        padding: 10px;
        font-size: 16px;
        border-radius: 4px 0 0 4px;
        border: none;
    }

    button {
        padding: 10px 15px;
        font-size: 16px;
        cursor: pointer;
        border: none;
        border-radius: 0 4px 4px 0;
        background: #f5c518;
        font-weight: bold;
    }

    .results {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
        gap: 15px;
        padding: 20px;
    }

    .card {
        background: #1a1a1a;
        padding: 10px;
        border-radius: 6px;
    }

    .card img {
        width: 100%;
        border-radius: 4px;
    }

    .play-button {
        background: #f5c518;
        border: none;
        padding: 8px 12px;
        font-weight: bold;
        cursor: pointer;
        border-radius: 4px;
        margin-top: 5px;
    }

    /* Fullscreen video container */
    #video-container {
        position: fixed;
        top: 80px; /* height of top-bar */
        left: 0;
        right: 0;
        bottom: 0;
        background: #000;
        display: none; /* hidden by default */
        z-index: 5;
    }

    #video-container iframe {
        width: 100%;
        height: 100%;
        border: none;
    }

    /* Optional: hide scroll when video is open */
    body.video-playing {
        overflow: hidden;
    }
</style>
</head>
<body>

<div class="top-bar">
    <h1>prism &lt;3</h1>
    <div class="search-box">
        <input id="query" placeholder="Search movie or TV show..." />
        <button onclick="search()">Search</button>
    </div>
</div>

<div id="video-container"></div>
<div class="results" id="results"></div>

<script>
const API_KEY = "65277ee3";
const TMDB_API_KEY = "a7856adff8aa06bd9d9fa0b21d0ea593";

async function search() {
    const q = document.getElementById("query").value.trim();
    if (!q) return;

    const res = await fetch(`https://www.omdbapi.com/?apikey=${API_KEY}&s=${encodeURIComponent(q)}`);
    const data = await res.json();

    const resultsDiv = document.getElementById("results");
    resultsDiv.innerHTML = "";

    if (data.Response === "False") {
        resultsDiv.innerHTML = "<p style='padding:20px'>No results found.</p>";
        return;
    }

    data.Search.forEach(item => {
        const card = document.createElement("div");
        card.className = "card";

        card.innerHTML = `
            <img src="${item.Poster !== "N/A" ? item.Poster : ""}">
            <h3>${item.Title} (${item.Type})</h3>
            <button class="play-button">Play</button>
        `;

        card.querySelector(".play-button").addEventListener("click", async () => {
            let tmdbId;
            let embedUrl;

            if (item.Type === "series") {
                const tmdbRes = await fetch(`https://api.themoviedb.org/3/search/tv?api_key=${TMDB_API_KEY}&query=${encodeURIComponent(item.Title)}`);
                const tmdbData = await tmdbRes.json();
                if (tmdbData.results && tmdbData.results.length > 0) {
                    tmdbId = tmdbData.results[0].id;
                    embedUrl = `https://vidlink.pro/tv/${tmdbId}/1/1`;
                } else {
                    alert("TMDb TV ID not found");
                    return;
                }
            } else if (item.Type === "movie") {
                const tmdbRes = await fetch(`https://api.themoviedb.org/3/search/movie?api_key=${TMDB_API_KEY}&query=${encodeURIComponent(item.Title)}`);
                const tmdbData = await tmdbRes.json();
                if (tmdbData.results && tmdbData.results.length > 0) {
                    tmdbId = tmdbData.results[0].id;
                    embedUrl = `https://vidlink.pro/movie/${tmdbId}`;
                } else {
                    alert("TMDb Movie ID not found");
                    return;
                }
            }

            // Show video in full-screen container
            const videoContainer = document.getElementById("video-container");
            videoContainer.innerHTML = `<iframe src="${embedUrl}" allowfullscreen></iframe>`;
            videoContainer.style.display = "block";
            document.body.classList.add("video-playing");
        });

        resultsDiv.appendChild(card);
    });
}

// Optional: click outside video to close
document.getElementById("video-container").addEventListener("click", () => {
    const videoContainer = document.getElementById("video-container");
    videoContainer.style.display = "none";
    videoContainer.innerHTML = "";
    document.body.classList.remove("video-playing");
});
</script>

</body>
</html>
